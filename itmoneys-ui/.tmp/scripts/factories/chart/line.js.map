{"version":3,"sources":["factories/chart/line.js"],"names":["LineChars","target","args","init","prototype","canvas","document","createElement","width","height","context","getContext","margin","top","right","bottom","left","x","d3","scaleTime","range","y","scaleLinear","line","d","time","cpu","curve","curveStep","xAxis","tickCount","tickSize","ticks","tickFormat","beginPath","forEach","moveTo","lineTo","strokeStyle","stroke","textAlign","textBaseline","fillText","yAxis","tickPadding","save","rotate","Math","PI","font","restore","render","data","translate","parseTime","timeParse","domain","extent","lineWidth","$","appendTo","BaseChart","oArgs","empty","now","Date","yesterday","values","xScale","getXScale","yScale","getYScale","getXAxis","getYAxis","svg","select","append","attr","call","selectAll","xAxisLabel","TimeSeries","length","lineGenerator","enter","on","el","max","nice","scale","axisBottom","timeMinutes","axisLeft","format","timeFormat","dateFormat","each","text","content","SparkLine","datum","app","factory","getChart"],"mappings":"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","file":"line.js","sourcesContent":["'use strict';\r\n\r\n/*---------*/\r\n\r\nfunction LineChars(target, args) {\r\n    this.init(target, args);\r\n}\r\nLineChars.prototype.init = function (target, args) {\r\n    this.target = target;\r\n    args = args || {};\r\n    this.canvas = document.createElement('canvas');\r\n    this.canvas.width = 960;\r\n    this.canvas.height = 500;\r\n\r\n    this.context = this.canvas.getContext('2d');\r\n\r\n\r\n    this.margin = args.margin || {top: 20, right: 20, bottom: 30, left: 50};\r\n    this.width = this.canvas.width - this.margin.left - this.margin.right;\r\n    this.height = this.canvas.height - this.margin.top - this.margin.bottom;\r\n\r\n    this.x = d3.scaleTime()\r\n        .range([0, this.width]);\r\n\r\n    this.y = d3.scaleLinear()\r\n        .range([this.height, 0]);\r\n    let x = this.x;\r\n    let y = this.y;\r\n    this.line = d3.line()\r\n        .x(function (d) {\r\n            return x(d.time);\r\n        })\r\n        .y(function (d) {\r\n            return y(d.cpu);\r\n        })\r\n        .curve(d3.curveStep).context(this.context);\r\n\r\n\r\n};\r\nLineChars.prototype.xAxis = function () {\r\n    let height = this.height;\r\n    let x = this.x;\r\n    let context = this.context;\r\n    let tickCount = 10,\r\n        tickSize = 6,\r\n        ticks = x.ticks(tickCount),\r\n        tickFormat = x.tickFormat();\r\n\r\n    context.beginPath();\r\n    ticks.forEach(function (d) {\r\n        context.moveTo(x(d), height);\r\n        context.lineTo(x(d), height + tickSize);\r\n    });\r\n    context.strokeStyle = 'black';\r\n    context.stroke();\r\n    context.textAlign = 'center';\r\n    context.textBaseline = 'top';\r\n    ticks.forEach(function (d) {\r\n        context.fillText(tickFormat(d), x(d), height + tickSize);\r\n    });\r\n};\r\n\r\nLineChars.prototype.yAxis = function () {\r\n    let height = this.height;\r\n    let y = this.y;\r\n    let context = this.context;\r\n    let tickCount = 10,\r\n        tickSize = 6,\r\n        tickPadding = 3,\r\n        ticks = y.ticks(tickCount),\r\n        tickFormat = y.tickFormat(tickCount);\r\n\r\n    context.beginPath();\r\n    ticks.forEach(function (d) {\r\n        context.moveTo(0, y(d));\r\n        context.lineTo(-6, y(d));\r\n    });\r\n    context.strokeStyle = 'black';\r\n    context.stroke();\r\n\r\n    context.beginPath();\r\n    context.moveTo(-tickSize, 0);\r\n    context.lineTo(0.5, 0);\r\n    context.lineTo(0.5, height);\r\n    context.lineTo(-tickSize, height);\r\n    context.strokeStyle = 'black';\r\n    context.stroke();\r\n\r\n    context.textAlign = 'right';\r\n    context.textBaseline = 'middle';\r\n    ticks.forEach(function (d) {\r\n        context.fillText(tickFormat(d), -tickSize - tickPadding, y(d));\r\n    });\r\n\r\n    context.save();\r\n    context.rotate(-Math.PI / 2);\r\n    context.textAlign = 'right';\r\n    context.textBaseline = 'top';\r\n    context.font = 'bold 10px sans-serif';\r\n    context.fillText('Price (US$)', -10, 10);\r\n    context.restore();\r\n};\r\nLineChars.prototype.render = function (data) {\r\n    this.context.translate(this.margin.left, this.margin.top);\r\n    let parseTime = d3.timeParse('%d-%b-%y');\r\n    let context = this.context;\r\n    this.x.domain(d3.extent(data, function (d) {\r\n        return parseTime(d.time);\r\n    }));\r\n    this.y.domain(d3.extent(data, function (d) {\r\n        return +d.cpu;\r\n    }));\r\n\r\n    this.xAxis();\r\n    this.yAxis();\r\n\r\n    context.beginPath();\r\n    this.line(data);\r\n    context.lineWidth = 1.5;\r\n    context.strokeStyle = 'steelblue';\r\n    context.stroke();\r\n    $(this.canvas).appendTo(this.target);\r\n};\r\n\r\nfunction BaseChart(target, oArgs) {\r\n    this.init(target, oArgs);\r\n}\r\n\r\nBaseChart.prototype.init = function (target, oArgs) {\r\n    this.target = target;\r\n    this.context = target;\r\n\r\n    oArgs = oArgs || {};\r\n    this.width = oArgs.width;\r\n    this.height = oArgs.height;\r\n    this.margin = oArgs.margin || 0;\r\n};\r\n\r\nBaseChart.prototype.empty = function () {\r\n    let now = Date.now(),\r\n        yesterday = now - (60 * 60 * 1000);\r\n    let values = [{\r\n        time: yesterday,\r\n        cpu: 0\r\n    }, {\r\n        time: now,\r\n        cpu: 1\r\n    }];\r\n\r\n    let xScale = this.getXScale(values);\r\n    let yScale = this.getYScale(values);\r\n\r\n    let xAxis = this.getXAxis(xScale);\r\n    let yAxis = this.getYAxis(yScale);\r\n\r\n    let svg = d3.select(this.target).append('svg')\r\n        .attr('width', this.width)\r\n        .attr('height', this.height);\r\n\r\n    svg.append('g')\r\n        .attr('class', 'x axis')\r\n        .attr('transform', 'translate(0, ' + (this.height - this.margin) + ')')\r\n        .call(xAxis);\r\n\r\n    d3.selectAll('.x.axis .tick text')\r\n        .call(this.xAxisLabel, xScale);\r\n\r\n    svg.append('g')\r\n        .attr('class', 'y axis')\r\n        .attr('transform', 'translate(' + this.margin + ', 0)')\r\n        .call(yAxis);\r\n\r\n    return svg;\r\n};\r\n\r\n\r\nfunction TimeSeries(target, oArgs) {\r\n    this.init(target, oArgs);\r\n}\r\nTimeSeries.prototype = new BaseChart();\r\n\r\nTimeSeries.prototype.render = function (values) {\r\n    if (values.length === 0) {\r\n        return this.empty();\r\n    }\r\n\r\n    let xScale = this.getXScale(values);\r\n    let yScale = this.getYScale(values);\r\n\r\n    let xAxis = this.getXAxis(xScale);\r\n    let yAxis = this.getYAxis(yScale);\r\n\r\n    let line = this.lineGenerator(xScale, yScale);\r\n\r\n    let svg = d3.select(this.target).append('svg')\r\n        .attr('width', this.width)\r\n        .attr('height', this.height);\r\n\r\n    svg.append('g')\r\n        .attr('class', 'x axis')\r\n        .attr('transform', 'translate(0, ' + (this.height - this.margin) + ')')\r\n        .call(xAxis);\r\n\r\n    svg.selectAll('.x.axis .tick text')\r\n        .call(this.xAxisLabel, xScale);\r\n\r\n    svg.append('g')\r\n        .attr('class', 'y axis')\r\n        .attr('transform', 'translate(' + this.margin + ', 0)')\r\n        .call(yAxis);\r\n\r\n    svg.append('path')\r\n        .attr('d', line(values));\r\n\r\n    svg.selectAll('.dot')\r\n        .data(values)\r\n        .enter().append('circle')\r\n        .attr('class', 'dot')\r\n        .attr('r', 3.5)\r\n        .attr('cx', function (d) {\r\n            return xScale(d.time);\r\n        })\r\n        .attr('cy', function (d) {\r\n            return yScale(d.cpu);\r\n        })\r\n        .on('mouseover', function (el) {\r\n            d3.select(this)\r\n                .attr('r', 5);\r\n        })\r\n        .on('mouseout', function (el) {\r\n            d3.select(this)\r\n                .attr('r', 3.5);\r\n        });\r\n\r\n    return svg;\r\n};\r\n\r\nTimeSeries.prototype.getXScale = function (values) {\r\n    return d3.scaleTime()\r\n        .domain([values[0].time, values[values.length - 1].time])\r\n        .range([0 + this.margin, this.width]);\r\n};\r\n\r\nTimeSeries.prototype.getYScale = function (values) {\r\n    return d3.scaleLinear()\r\n        .range([this.height - this.margin, 0])\r\n        .domain([0, d3.max(values, function (d) {\r\n            return d.cpu;\r\n        })]).nice();\r\n};\r\n\r\nTimeSeries.prototype.getXAxis = function (scale) {\r\n    return d3.axisBottom(scale)\r\n        .ticks(d3.timeMinutes, 15);\r\n};\r\n\r\nTimeSeries.prototype.getYAxis = function (scale) {\r\n    return d3.axisLeft(scale)\r\n        .ticks(6)\r\n        .tickFormat(d3.format('.0%'));\r\n};\r\n\r\nTimeSeries.prototype.lineGenerator = function (xScale, yScale) {\r\n    return d3.line()\r\n        .x(function (d) {\r\n            return xScale(d.time);\r\n        })\r\n        .y(function (d) {\r\n            return yScale(d.cpu);\r\n        });\r\n};\r\n\r\nTimeSeries.prototype.xAxisLabel = function (scale) {\r\n    /*\r\n     * Override this method to customize X Axis labels.\r\n     */\r\n    let timeFormat = d3.time.format('%I:%M %p');\r\n    let dateFormat = d3.time.format('%d %b');\r\n\r\n    scale.each(function (d) {\r\n        let text = d3.select(this),\r\n            content = text.text();\r\n        text.text(null)\r\n            .append('tspan')\r\n            .attr('x', 0)\r\n            .text(timeFormat(d));\r\n        text.append('tspan')\r\n            .attr('x', 0)\r\n            .attr('dy', 13).text(dateFormat(d));\r\n    });\r\n};\r\n\r\nfunction SparkLine(target, oArgs) {\r\n    this.init(target, oArgs);\r\n}\r\nSparkLine.prototype = new TimeSeries();\r\n\r\nSparkLine.prototype.getXScale = function (values) {\r\n    return d3.scaleTime()\r\n        .domain([values[0].time, values[values.length - 1].time])\r\n        .range([0, this.width]);\r\n};\r\n\r\nSparkLine.prototype.getYScale = function (values) {\r\n    return d3.scaleLinear()\r\n        .range([this.height, 0])\r\n        .domain(d3.extent(values, function (d) {\r\n            return d.cpu;\r\n        }));\r\n};\r\n\r\nSparkLine.prototype.render = function (values) {\r\n    let xScale = this.getXScale(values);\r\n    let yScale = this.getYScale(values);\r\n\r\n    let xAxis = this.getXAxis(xScale);\r\n    let yAxis = this.getYAxis(yScale);\r\n\r\n    let line = this.lineGenerator(xScale, yScale);\r\n\r\n    let svg = d3.select(this.target).append('svg')\r\n        .attr('width', this.width)\r\n        .attr('height', this.height)\r\n        .append('path')\r\n        .datum(values)\r\n        .attr('class', 'sparkline')\r\n        .attr('d', line(values));\r\n\r\n    return svg;\r\n};\r\n\r\napp.factory('TimeSeriesChart', function () {\r\n    return {\r\n        getChart: function (target, oArgs) {\r\n            return new LineChars(target, oArgs);\r\n        }\r\n    };\r\n}).factory('SparkLineChart', function () {\r\n    return {\r\n        getChart: function (target, oArgs) {\r\n            return new SparkLine(target, oArgs);\r\n        }\r\n    };\r\n});\r\n"]}